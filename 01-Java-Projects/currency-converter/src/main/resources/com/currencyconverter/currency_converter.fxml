<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.chart.LineChart?>
<?import javafx.scene.chart.NumberAxis?>
<?import javafx.scene.chart.CategoryAxis?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<BorderPane xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.currencyconverter.controller.CurrencyConverterController"
            stylesheets="@css/style.css"
            prefHeight="700.0" prefWidth="900.0">

    <!-- Header -->
    <top>
        <VBox styleClass="header">
            <padding>
                <Insets top="20" right="20" bottom="20" left="20"/>
            </padding>
            <Label text="Currency Converter" styleClass="title"/>
            <Label text="Convertitore di Valuta in Tempo Reale" styleClass="subtitle"/>
        </VBox>
    </top>

    <!-- Center Content -->
    <center>
        <VBox spacing="20" alignment="CENTER">
            <padding>
                <Insets top="20" right="30" bottom="20" left="30"/>
            </padding>

            <!-- Conversion Panel -->
            <GridPane hgap="15" vgap="15" alignment="CENTER" styleClass="conversion-panel">
                <columnConstraints>
                    <ColumnConstraints hgrow="NEVER" minWidth="120"/>
                    <ColumnConstraints hgrow="ALWAYS" minWidth="200"/>
                    <ColumnConstraints hgrow="NEVER" minWidth="60"/>
                </columnConstraints>
                <rowConstraints>
                    <RowConstraints vgrow="NEVER" minHeight="40"/>
                    <RowConstraints vgrow="NEVER" minHeight="40"/>
                    <RowConstraints vgrow="NEVER" minHeight="40"/>
                    <RowConstraints vgrow="NEVER" minHeight="30"/>
                </rowConstraints>

                <!-- From Currency -->
                <Label text="Da:" GridPane.columnIndex="0" GridPane.rowIndex="0" styleClass="label"/>
                <ComboBox fx:id="fromCurrencyCombo" GridPane.columnIndex="1" GridPane.rowIndex="0"
                          prefWidth="200" maxWidth="Infinity"/>
                <Button fx:id="swapButton" text="â‡„" onAction="#handleSwap" GridPane.columnIndex="2"
                       GridPane.rowIndex="0" styleClass="swap-button"/>

                <!-- To Currency -->
                <Label text="A:" GridPane.columnIndex="0" GridPane.rowIndex="1" styleClass="label"/>
                <ComboBox fx:id="toCurrencyCombo" GridPane.columnIndex="1" GridPane.rowIndex="1"
                          prefWidth="200" maxWidth="Infinity"/>

                <!-- Amount -->
                <Label text="Importo:" GridPane.columnIndex="0" GridPane.rowIndex="2" styleClass="label"/>
                <TextField fx:id="amountTextField" GridPane.columnIndex="1" GridPane.rowIndex="2"
                          promptText="Inserisci importo" prefWidth="200" maxWidth="Infinity"/>
                <Button fx:id="convertButton" text="Converti" onAction="#handleConvert"
                       GridPane.columnIndex="2" GridPane.rowIndex="2" styleClass="convert-button"/>

                <!-- Result -->
                <Label text="Risultato:" GridPane.columnIndex="0" GridPane.rowIndex="3" styleClass="label"/>
                <Label fx:id="resultLabel" text="---" GridPane.columnIndex="1" GridPane.rowIndex="3"
                      styleClass="result-label"/>
            </GridPane>

            <!-- Rate Info -->
            <HBox spacing="20" alignment="CENTER" styleClass="rate-info">
                <Label fx:id="rateLabel" text="Tasso: ---" styleClass="rate-label"/>
                <Label fx:id="lastUpdateLabel" text="Aggiornamento: ---" styleClass="update-label"/>
                <Region HBox.hgrow="ALWAYS"/>
                <Button fx:id="refreshButton" text="ðŸ”„ Aggiorna" onAction="#handleRefresh"
                       styleClass="refresh-button"/>
                <ProgressIndicator fx:id="loadingIndicator" maxWidth="25" maxHeight="25"/>
            </HBox>

            <!-- Chart -->
            <VBox VBox.vgrow="ALWAYS" styleClass="chart-container">
                <LineChart fx:id="historyChart" legendVisible="false">
                    <xAxis>
                        <CategoryAxis fx:id="xAxis" label="Data"/>
                    </xAxis>
                    <yAxis>
                        <NumberAxis fx:id="yAxis" label="Tasso di Cambio"/>
                    </yAxis>
                </LineChart>
            </VBox>

        </VBox>
    </center>

    <!-- Footer -->
    <bottom>
        <HBox styleClass="footer" alignment="CENTER">
            <padding>
                <Insets top="10" right="20" bottom="10" left="20"/>
            </padding>
            <Label text="Dati forniti da ExchangeRate.host API | Cache: 1 ora"/>
        </HBox>
    </bottom>

</BorderPane>
