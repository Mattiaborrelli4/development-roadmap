# Log Analyzer Configuration Patterns
# Questo file definisce i pattern per riconoscere e analizzare diversi formati di log

# Pattern per i livelli di log
log_levels:
  - ERROR
  - WARN
  - WARNING
  - INFO
  - DEBUG
  - TRACE
  - FATAL
  - CRITICAL

# Formati di log supportati
formats:
  # Apache Common Log Format (CLF)
  apache_clf: >
    ^(?P<ip>\d+\.\d+\.\d+\.\d+)\s+
    (?P<identity>\S+)\s+
    (?P<userid>\S+)\s+
    \[(?P<timestamp>[^\]]+)\]\s+
    "(?P<method>\S+)\s+(?P<path>\S+)\s+(?P<protocol>\S+)"\s+
    (?P<status>\d+)\s+
    (?P<size>\d+)$

  # Apache Combined Log Format
  apache_combined: >
    ^(?P<ip>\d+\.\d+\.\d+\.\d+)\s+
    (?P<identity>\S+)\s+
    (?P<userid>\S+)\s+
    \[(?P<timestamp>[^\]]+)\]\s+
    "(?P<method>\S+)\s+(?P<path>\S+)\s+(?P<protocol>\S+)"\s+
    (?P<status>\d+)\s+
    (?P<size>\d+)\s+
    "(?P<referer>[^"]*)"\s+
    "(?P<user_agent>[^"]*)"$

  # Nginx default format
  nginx_default: >
    ^(?P<ip>\d+\.\d+\.\d+\.\d+)\s+
    (?P<identity>\S+)\s+
    (?P<userid>\S+)\s+
    \[(?P<timestamp>[^\]]+)\]\s+
    "(?P<method>\S+)\s+(?P<path>\S+)\s+(?P<protocol>\S+)"\s+
    (?P<status>\d+)\s+
    (?P<size>\d+)\s+
    "(?P<referer>[^"]*)"\s+
    "(?P<user_agent>[^"]*)"\s*
    "(?P<x_forwarded_for>[^"]*)"?$

  # Custom application log format
  custom_app: >
    ^\[(?P<timestamp>[^\]]+)\]\s+
    (?P<level>\w+)\s+
    \[(?P<module>[^\]]+)\]\s+
    (?P<message>.*)$

  # Simple custom format
  custom_simple: >
    ^(?P<timestamp>\d{4}-\d{2}-\d{2}\s+\d{2}:\d{2}:\d{2})\s+
    \[(?P<level>\w+)\]\s+
    (?P<message>.*)$

# Pattern per estrarre IP addresses
ip_patterns:
  - '\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\b'
  - '\b(?:[0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}\b'
  - '\b(?:[0-9a-fA-F]{1,4}:){1,7}:?[0-9a-fA-F]{1,4}\b'

# Pattern per errori comuni
error_patterns:
  database:
    - 'database connection failed'
    - 'deadlock'
    - 'timeout exceeded'
    - 'constraint violation'
    - 'sql error'

  network:
    - 'connection refused'
    - 'connection timeout'
    - 'network unreachable'
    - 'dns resolution failed'
    - 'socket error'

  http:
    - 'HTTP 500'
    - 'HTTP 502'
    - 'HTTP 503'
    - 'HTTP 504'
    - 'status code 40'
    - 'Internal Server Error'
    - 'Bad Gateway'

  security:
    - 'unauthorized access'
    - 'authentication failed'
    - 'permission denied'
    - 'invalid token'
    - 'brute force'
    - 'sql injection'
    - 'xss attack'

  application:
    - 'NullPointerException'
    - 'IndexError'
    - 'KeyError'
    - 'ValueError'
    - 'exception occurred'
    - 'fatal error'

# Codici di stato HTTP
http_status_codes:
  # Success
  200: OK
  201: Created
  204: No Content

  # Redirection
  301: Moved Permanently
  302: Found
  304: Not Modified

  # Client Error
  400: Bad Request
  401: Unauthorized
  403: Forbidden
  404: Not Found
  429: Too Many Requests

  # Server Error
  500: Internal Server Error
  502: Bad Gateway
  503: Service Unavailable
  504: Gateway Timeout

# Impostazioni per l'analisi
analysis:
  # Intervallo di tempo per aggregazione (minute, hour, day)
  default_interval: hour

  # Numero di top results da mostrare
  top_n: 10

  # Soglie per avvisi
  thresholds:
    error_rate_warning: 5  # percentuale
    error_rate_critical: 10  # percentuale
    unique_ips_warning: 100
    response_time_warning: 1000  # millisecondi

# Impostazioni per i report
reporting:
  # Formato data predefinito
  date_format: "%Y-%m-%d %H:%M:%S"

  # Timezone
  timezone: UTC

  # Formato output
  formats:
    - text
    - html
    - json
