# 🔐 Secure Notes Manager - Visual Guide

## Concetto Visuale

```
┌─────────────────────────────────────────────────────────────────────────┐
│                        SECURE NOTES MANAGER                             │
│                                                                          │
│    ┌────────────┐                                                         │
│    │    USER    │                                                         │
│    └─────┬──────┘                                                         │
│          │                                                                │
│          │ Password Master                                                │
│          ▼                                                                │
│    ┌──────────────────────────────────────────────────────────┐          │
│    │                  PASSWORD VERIFICATION                     │          │
│    │  ┌────────────────┐    ┌──────────────────┐                │          │
│    │  │ Strength Meter │    │  PBKDF2 (100k)   │                │          │
│    │  │   Score 0-100   │───▶│  Derive Key       │                │          │
│    │  └────────────────┘    └────────┬─────────┘                │          │
│    │                                 │                          │          │
│    │                                 ▼                          │          │
│    │                         ┌──────────────┐                   │          │
│    │                         │   Salt       │                   │          │
│    │                         │  (16 bytes) │                   │          │
│    │                         └──────────────┘                   │          │
│    └──────────────────────────────────────────────────────────┘          │
│                                  │                                     │
│                                  ▼                                     │
│    ┌──────────────────────────────────────────────────────────┐          │
│    │                     CRYPTO MANAGER                         │          │
│    │  ┌────────────────────────────────────────────┐           │          │
│    │  │         FERNET (AES-128-CBC + HMAC)         │           │          │
│    │  │                                            │           │          │
│    │  │   ┌─────────┐    ┌─────────┐    ┌────────┐│           │          │
│    │  │   │   AES   │    │  HMAC   │    │   IV   ││           │          │
│    │  │   │ 128-bit │    │ SHA256  │    │  Auto  ││           │          │
│    │  │   └─────────┘    └─────────┘    └────────┘│           │          │
│    │  │                                            │           │          │
│    │  │   Confidenzialità + Integrità + Auth       │           │          │
│    │  └────────────────────────────────────────────┘           │          │
│    └──────────────────────────────────────────────────────────┘          │
│                                  │                                     │
│                                  ▼                                     │
│    ┌──────────────────────────────────────────────────────────┐          │
│    │                      STORAGE LAYER                          │          │
│    │  ┌──────────────┐    ┌─────────────┐    ┌─────────────┐   │          │
│    │  │   VAULT      │    │   BACKUPS   │    │   EXPORT    │   │          │
│    │  │  vault.enc   │    │  backups/   │    │  *.enc      │   │          │
│    │  └──────────────┘    └─────────────┘    └─────────────┘   │          │
│    └──────────────────────────────────────────────────────────┘          │
│                                  │                                     │
│                                  ▼                                     │
│    ┌──────────────────────────────────────────────────────────┐          │
│    │                       APPLICATION                          │          │
│    │  ┌────────┐  ┌───────┐  ┌──────┐  ┌──────┐  ┌────────┐  │          │
│    │  │  ADD   │  │ VIEW  │  │ EDIT │  │DELETE │  │ SEARCH │  │          │
│    │  └────────┘  └───────┘  └──────┘  └──────┘  └────────┘  │          │
│    └──────────────────────────────────────────────────────────┘          │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘
```

## Flusso di Autenticazione

```
┌──────────────┐
│   USER       │
└──────┬───────┘
       │
       │ 1. Inserisci Password
       ▼
┌──────────────────┐
│ Password Checker  │
├──────────────────┤
│ • Length          │
│ • Complexity      │
│ • Score 0-100     │
└──────┬───────────┘
       │
       │ 2. Verifica Robustezza
       ▼
┌──────────────────┐      ┌──────────────┐
│  IF Score >= 40   │────▶│  CONTINUA     │
└──────────────────┘      └──────┬───────┘
                               │
       ┌───────────────────────┘
       │
       ▼
┌──────────────────┐
│   PBKDF2 Start    │
├──────────────────┤
│ • Generate Salt   │
│ • Hash Password   │
│ • 100k Iterations │
└──────┬───────────┘
       │
       │ 3. Deriva Chiave
       ▼
┌──────────────────┐
│  Key Generated   │
├──────────────────┤
│ • 256-bit        │
│ • Base64         │
│ • Fernet Ready   │
└──────┬───────────┘
       │
       │ 4. Chiave Pronta
       ▼
┌──────────────────┐
│  VAULT UNLOCKED   │◀────────────────┐
└──────────────────┘                  │
                                    │
                       ┌────────────┴──────────┐
                       │  Unlock Fails         │
                       │  Wrong Password?      │
                       └───────────────────────┘
```

## Crittografia di una Nota

```
┌──────────────────┐
│   NOTA ORIGINALE │
├──────────────────┤
│ {                │
│   "id": 1,       │
│   "title": "...",│
│   "content":".." │
│ }                │
└────────┬─────────┘
         │
         │ JSON Serialize
         ▼
┌──────────────────┐
│  JSON STRING     │
├──────────────────┤
│ '{"id":1,...}'   │
└────────┬─────────┘
         │
         │ UTF-8 Encode
         ▼
┌──────────────────┐
│    BYTES         │
├──────────────────┤
│ b'{"id":1,...}'  │
└────────┬─────────┘
         │
         │ Fernet Encrypt
         ▼
┌────────────────────────────────────────┐
│          FERNET ENCRYPTION              │
├────────────────────────────────────────┤
│ ┌───────────────────────────────────┐  │
│ │  1. Generate Random IV             │  │
│ │  2. AES-128-CBC Encrypt             │  │
│ │  3. Compute HMAC-SHA256             │  │
│ │  4. Add Timestamp                  │  │
│ │  5. Pack: IV + Ciphertext + HMAC    │  │
│ └───────────────────────────────────┘  │
└────────────────┬───────────────────────┘
               │
               │ Encrypted Bytes
               ▼
┌──────────────────┐
│  ENCRYPTED      │
├──────────────────┤
│ gAAAAABl1...    │
│ (Base64)        │
└─────────────────┘
```

## Decrittografia di una Nota

```
┌──────────────────┐
│  ENCRYPTED      │
├──────────────────┤
│ gAAAAABl1...    │
└────────┬─────────┘
         │
         │ Fernet Decrypt
         ▼
┌────────────────────────────────────────┐
│         FERNET DECRYPTION               │
├────────────────────────────────────────┤
│ ┌───────────────────────────────────┐  │
│ │  1. Verify HMAC                    │  │
│ │  2. Check Timestamp                │  │
│ │  3. Extract IV                     │  │
│ │  4. AES-128-CBC Decrypt             │  │
│ │  5. Return Plaintext               │  │
│ └───────────────────────────────────┘  │
└────────────────┬───────────────────────┘
               │
               │ IF Valid
               ▼
┌──────────────────┐
│    BYTES        │
├──────────────────┤
│ b'{"id":1,...}'  │
└────────┬─────────┘
         │
         │ UTF-8 Decode
         ▼
┌──────────────────┐
│  JSON STRING    │
├──────────────────┤
│ '{"id":1,...}'   │
└────────┬─────────┘
         │
         │ JSON Parse
         ▼
┌──────────────────┐
│   NOTA (DICT)   │
├──────────────────┤
│ {                │
│   "id": 1,       │
│   "title": "...",│
│   "content":".." │
│ }                │
└─────────────────┘
```

## Operazioni CRUD

```
┌──────────────────────────────────────────────────────────────┐
│                         CREATE                               │
├──────────────────────────────────────────────────────────────┤
│  1. unlock()      → Sblocca vault                             │
│  2. add()         → Crea nuova nota                            │
│  3. encrypt()     → Cripta nota                                │
│  4. save()        → Salva vault crittografato                   │
└──────────────────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────────────────┐
│                          READ                                 │
├──────────────────────────────────────────────────────────────┤
│  1. unlock()      → Sblocca vault                             │
│  2. decrypt()     → Decrittoga vault                           │
│  3. view/list()   → Visualizza note                            │
│  4. [in memory]   → Note mai salvate in chiaro                 │
└──────────────────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────────────────┐
│                         UPDATE                                │
├──────────────────────────────────────────────────────────────┤
│  1. unlock()      → Sblocca vault                             │
│  2. decrypt()     → Decrittoga vault                           │
│  3. edit()        → Modifica nota                              │
│  4. encrypt()     → Re-cripta vault                            │
│  5. save()        → Salva vault aggiornato                      │
└──────────────────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────────────────┐
│                         DELETE                                │
├──────────────────────────────────────────────────────────────┤
│  1. unlock()      → Sblocca vault                             │
│  2. decrypt()     → Decrittoga vault                           │
│  3. delete()      → Rimuovi nota                               │
│  4. encrypt()     → Re-cripta vault                            │
│  5. save()        → Salva vault aggiornato                      │
│  6. backup()      → Crea backup auto pre-delete                 │
└──────────────────────────────────────────────────────────────┘
```

## Backup Strategy

```
┌─────────────────────────────────────────────────────────────┐
│                     BACKUP FLOW                             │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│   VAULT → ┌─────────────────────────────────────┐          │
│            │  BEFORE: Create Auto Backup         │          │
│            │  Location: backups/auto_*.enc       │          │
│            └─────────────────────────────────────┘          │
│                      │                                      │
│                      ▼                                      │
│   MODIFY → ┌─────────────────────────────────────┐          │
│            │  Perform Operation                   │          │
│            │  (Add/Edit/Delete)                   │          │
│            └─────────────────────────────────────┘          │
│                      │                                      │
│                      ▼                                      │
│   EXPORT → ┌─────────────────────────────────────┐          │
│            │  Manual Export Command              │          │
│            │  Location: user-defined             │          │
│            └─────────────────────────────────────┘          │
│                                                             │
└─────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────┐
│                  RETENTION POLICY                            │
├─────────────────────────────────────────────────────────────┤
│  • Auto Backups: Last 10 only                               │
│  • Manual Backups: Unlimited                                 │
│  • Format: .enc (encrypted JSON)                            │
│  • Naming: auto_YYYYMMDD_HHMMSS.enc                          │
└─────────────────────────────────────────────────────────────┘
```

## Security Layers

```
┌────────────────────────────────────────────────────────────┐
│                    LAYER 1: PASSWORD                        │
│  • Strength Meter (0-100 score)                             │
│  • Feedback suggestions                                     │
│  • Minimum requirements                                     │
└────────────────────────────────────────────────────────────┘
                          ↓
┌────────────────────────────────────────────────────────────┐
│                    LAYER 2: DERIVATION                       │
│  • PBKDF2-HMAC-SHA256                                        │
│  • 100,000 iterations                                       │
│  • Unique salt (16 bytes)                                    │
│  • 256-bit output                                            │
└────────────────────────────────────────────────────────────┘
                          ↓
┌────────────────────────────────────────────────────────────┐
│                    LAYER 3: ENCRYPTION                        │
│  • Fernet (AES-128-CBC)                                      │
│  • HMAC-SHA256 authentication                               │
│  • Random IV (auto-generated)                               │
│  • Timestamp protection                                     │
└────────────────────────────────────────────────────────────┘
                          ↓
┌────────────────────────────────────────────────────────────┐
│                    LAYER 4: STORAGE                           │
│  • Encrypted JSON on disk                                   │
│  • Never plain text                                          │
│  • Auto-backups                                             │
│  • Export/Import support                                    │
└────────────────────────────────────────────────────────────┘
```

## Attack Prevention

```
┌──────────────────────────────────────────────────────────┐
│                    BRUTE FORCE                             │
│  PREVENTION: PBKDF2 (100k iterations)                    │
│  RESULT: 100,000x slower (~10 attempts/sec)               │
└──────────────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────────────┐
│                 RAINBOW TABLES                            │
│  PREVENTION: Unique salt per vault (16 bytes)            │
│  RESULT: Pre-computed attacks useless                    │
└──────────────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────────────┐
│                  DATA TAMPERING                           │
│  PREVENTION: HMAC-SHA256                                 │
│  RESULT: Any modification detected                       │
└──────────────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────────────┐
│                  REPLAY ATTACKS                           │
│  PREVENTION: Fernet Timestamp                            │
│  RESULT: Old ciphertexts rejected                        │
└──────────────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────────────┐
│                    DATA LOSS                              │
│  PREVENTION: Auto + Manual Backups                       │
│  RESULT: Multiple restore points                         │
└──────────────────────────────────────────────────────────┘
```

---

**Visual Guide per Secure Notes Manager v1.0**
